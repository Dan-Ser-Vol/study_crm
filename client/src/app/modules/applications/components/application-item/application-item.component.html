<div class="mt-1"></div>
<mat-accordion class="example-headers-align">
  <mat-expansion-panel>
    <mat-expansion-panel-header class="flex-container">
      <mat-panel-title class="flex-item">{{
        application.name
      }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{
        application.surname
      }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{
        application.email
      }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{ application.age }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{
        application.course
      }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{
        application.course_format
      }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{
        application.course_type
      }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{
        application.status
      }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{ application.sum }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{
        application.group
      }}</mat-panel-title>
      <mat-panel-title class="flex-item">{{
        application.created_at | date: 'dd-MM-yyyy HH:mm'
      }}</mat-panel-title>
      <mat-panel-description class="flex-item">
        <mat-icon class="">account_circle</mat-icon>
        @if (manager && manager.name) {
          <span class="text-sky-600 ml-2">{{ manager.name }}</span>
        } @else {
          <span class="text-teal-600 ml-2">Free</span>
        }
      </mat-panel-description>
    </mat-expansion-panel-header>
    <div class="flex">
      <mat-card class="example-card">
        <mat-card-header>
          <div mat-card-avatar class="example-header-image"></div>
          <mat-card-title>{{
            application.name || 'not established'
          }}</mat-card-title>
          <mat-card-subtitle>{{
            application.surname || 'not established'
          }}</mat-card-subtitle>
          @if (application.manager && application.manager._id === me._id) {
            <div class="flex justify-center items-center ml-auto">
              <button (click)="edit()">
                <mat-icon
                  color="warn"
                  matTooltip="You can edit this application"
                  aria-hidden="true"
                  aria-label="Edit icon"
                  fontIcon="edit"></mat-icon>
              </button>
            </div>
          }
        </mat-card-header>
        <mat-card-content>
          <hr />
          <mat-list>
            <mat-list-item>
              <span matListItemTitle>Email</span>
              <span matListItemLine>{{
                application.email || 'not established'
              }}</span>
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Phone</span>
              <span>{{ application.phone || 'not established' }}</span>
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Age</span>
              {{ application.age || 'not established' }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Course</span>
              {{ application.course || 'not established' }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Course Format</span>
              {{ application.course_format || 'not established' }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Course Type</span>
              {{ application.course_type || 'not established' }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Sum</span>
              {{ application.sum || 'not established' }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Status</span>
              {{ application.status || 'not established' }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Group</span>
              {{ application.group || 'not established' }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Created</span>
              {{
                (application.created_at | date: 'dd-MM-yyyy HH:mm') ||
                  (application.createdAt | date: 'dd-MM-yyyy HH:mm') ||
                  'not established'
              }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Updated</span>
              {{
                (application.updated_at | date: 'dd-MM-yyyy HH:mm') ||
                  (application.updatedAt | date: 'dd-MM-yyyy HH:mm') ||
                  'not established'
              }}
            </mat-list-item>
            <mat-list-item style="margin-top: -20px">
              <span matListItemTitle>Manager</span>
              {{ manager?.name ? manager.name : 'free' }}
            </mat-list-item>
          </mat-list>
        </mat-card-content>
      </mat-card>
      <div class="ml-auto">
        <app-message-form
          [application]="application"
          [me]="me"
          [manager]="manager"
          (managerUpdated)="onManagerUpdated($event)" />
      </div>
    </div>
  </mat-expansion-panel>
</mat-accordion>
